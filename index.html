<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <title>水果庫存與價格</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- 載入 Supabase JS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        padding: 20px;
      }
      table {
        border-collapse: collapse;
        width: 100%;
        max-width: 500px;
      }
      th,
      td {
        padding: 8px 12px;
        border-bottom: 1px solid #ccc;
      }
      th {
        text-align: left;
      }
    </style>
  </head>
  <body>
    <h1>水果庫存與價格</h1>

    <table id="fruit-table">
      <thead>
        <tr>
          <th>名稱</th>
          <th>庫存</th>
          <th>價格</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td colspan="3">載入中...</td>
        </tr>
      </tbody>
    </table>

    <!-- ✅ 注意：從這裡開始才是 script，最後有 </script> -->
    <script>
      // 這裡換成你的 URL & Publishable key
     const supabase = window.supabase
       .createClient(
         "https://krfqqkukafhqieaygyka.supabase.co",
         "sb-publishable-xxxxxxxxxxxxxxx"
       );

      async function loadFruits() {
        const tbody = document.querySelector("#fruit-table tbody");
        tbody.innerHTML = `<tr><td colspan="3">載入中...</td></tr>`;

        const { data, error } = await supabase
          .from("fruits")
          .select("*")
          .order("id");

        if (error) {
          console.error(error);
          tbody.innerHTML = `<tr><td colspan="3">讀取失敗</td></tr>`;
          return;
        }

        if (!data || data.length === 0) {
          tbody.innerHTML = `<tr><td colspan="3">目前沒有資料</td></tr>`;
          return;
        }

        tbody.innerHTML = "";
        data.forEach((f) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${f.name}</td>
            <td>${f.stock}</td>
            <td>${f.price}</td>
          `;
          tbody.appendChild(tr);
        });
      }

      loadFruits();
    </script>
  </body>
</html>
